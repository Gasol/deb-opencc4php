#!/usr/bin/make -f
#DH_VERBOSE = 1

DPKG_EXPORT_BUILDFLAGS = 1
include /usr/share/dpkg/default.mk

# see FEATURE AREAS in dpkg-buildflags(1)
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all

# see ENVIRONMENT in dpkg-buildflags(1)
# package maintainers to append CFLAGS
#export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
# package maintainers to append LDFLAGS
#export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed


# main packaging script based on dh7 syntax
%:
	dh $@ --with php5


override_dh_auto_configure:
	phpize
	./configure

override_dh_auto_test:
	NO_INTERACTION=1 make test

override_dh_auto_install:

get_orig_source:
	git clone --depth=1 https://github.com/NauxLiu/opencc4php.git
	cd opencc4php && \
		DEB_VERSION=`git log -n 1 --pretty=0.0.0~git%ad.%h --date=short | tr -d '-'` && \
		git archive --prefix='opencc4php/' --format=tar.gz -o ../../opencc4php_$$DEB_VERSION.orig.tar.gz HEAD
	rm -rf opencc4php
